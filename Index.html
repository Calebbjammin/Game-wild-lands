<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üå≤ Wildlands - Combat Alpha</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      background: #1a1a1a;
      color: white;
      font-family: sans-serif;
      margin: 0;
      text-align: center;
    }

    canvas {
      background-color: #2c2c2c;
      border: 2px solid #555;
      display: block;
      margin: 0 auto;
    }

    .controls, .crafting {
      display: grid;
      grid-template-columns: repeat(3, 60px);
      gap: 5px;
      justify-content: center;
      margin-top: 10px;
    }

    .controls button, .crafting button {
      background: #444;
      border: none;
      color: white;
      font-size: 18px;
      border-radius: 8px;
      padding: 10px;
    }

    .controls button:active, .crafting button:active {
      background: #666;
    }

    .crafting {
      margin-top: 20px;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    @media (max-width: 768px) {
      canvas {
        width: 90vw;
        height: 60vh;
      }
    }
  </style>
</head>
<body>
  <h1>üå≤ Wildlands - Combat Alpha</h1>
  <canvas id="gameCanvas" width="800" height="600"></canvas>

  <div class="controls">
    <button></button>
    <button id="up">‚Üë</button>
    <button></button>
    <button id="left">‚Üê</button>
    <button></button>
    <button id="right">‚Üí</button>
    <button></button>
    <button id="down">‚Üì</button>
    <button></button>
  </div>

  <div class="crafting" id="craftingArea"></div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const player = {
      x: 100,
      y: 100,
      size: 32,
      color: "cyan",
      speed: 3,
      hp: 100,
      maxHp: 100,
      xp: 0,
    };

    const resources = [
      { x: 250, y: 200, size: 20, type: "wood", color: "brown" },
      { x: 400, y: 350, size: 20, type: "stone", color: "gray" },
      { x: 600, y: 120, size: 20, type: "berry", color: "purple" },
      { x: 500, y: 400, size: 20, type: "fiber", color: "green" },
    ];

    const inventory = {
      wood: 0,
      stone: 0,
      berry: 0,
      fiber: 0,
      stick: 0,
      "stone axe": 0,
      campfire: 0,
      "pet food": 0,
      sword: 0,
      chest: 0,
      "fishing rod": 0
    };

    const craftingRecipes = [
      { name: "Stick", requires: { wood: 2 }, produces: "stick" },
      { name: "Stone Axe", requires: { stone: 2, stick: 1 }, produces: "stone axe" },
      { name: "Campfire", requires: { wood: 3, stone: 2 }, produces: "campfire" },
      { name: "Pet Food", requires: { stick: 1, berry: 1 }, produces: "pet food" },
      { name: "Sword", requires: { stone: 3, stick: 1 }, produces: "sword" },
      { name: "Chest", requires: { wood: 5, stone: 2 }, produces: "chest" },
      { name: "Fishing Rod", requires: { stick: 2, fiber: 2 }, produces: "fishing rod" }
    ];

    const keys = { up: false, down: false, left: false, right: false };

    const monsters = [];

    function spawnMonster() {
      monsters.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: 28,
        color: "red",
        hp: 30,
        damage: 10,
      });
    }

    for (let i = 0; i < 3; i++) spawnMonster();

    // Touch controls
    document.getElementById("up").addEventListener("touchstart", () => keys.up = true);
    document.getElementById("down").addEventListener("touchstart", () => keys.down = true);
    document.getElementById("left").addEventListener("touchstart", () => keys.left = true);
    document.getElementById("right").addEventListener("touchstart", () => keys.right = true);
    document.getElementById("up").addEventListener("touchend", () => keys.up = false);
    document.getElementById("down").addEventListener("touchend", () => keys.down = false);
    document.getElementById("left").addEventListener("touchend", () => keys.left = false);
    document.getElementById("right").addEventListener("touchend", () => keys.right = false);

    // Keyboard controls
    document.addEventListener("keydown", (e) => {
      if (e.key === "w" || e.key === "ArrowUp") keys.up = true;
      if (e.key === "s" || e.key === "ArrowDown") keys.down = true;
      if (e.key === "a" || e.key === "ArrowLeft") keys.left = true;
      if (e.key === "d" || e.key === "ArrowRight") keys.right = true;
    });
    document.addEventListener("keyup", (e) => {
      if (e.key === "w" || e.key === "ArrowUp") keys.up = false;
      if (e.key === "s" || e.key === "ArrowDown") keys.down = false;
      if (e.key === "a" || e.key === "ArrowLeft") keys.left = false;
      if (e.key === "d" || e.key === "ArrowRight") keys.right = false;
    });

    // Combat (tap to attack)
    canvas.addEventListener("click", () => {
      monsters.forEach((m, i) => {
        if (Math.abs(player.x - m.x) < 50 && Math.abs(player.y - m.y) < 50) {
          m.hp -= 20;
          if (m.hp <= 0) {
            monsters.splice(i, 1);
            player.xp += 10;
            spawnMonster(); // Respawn a new one
          }
        }
      });
    });

    function updateCraftingMenu() {
      const craftingArea = document.getElementById("craftingArea");
      craftingArea.innerHTML = "";
      craftingRecipes.forEach(recipe => {
        const canCraft = Object.entries(recipe.requires).every(
          ([item, count]) => inventory[item] >= count
        );
        const btn = document.createElement("button");
        btn.textContent = `${recipe.name}`;
        btn.disabled = !canCraft;
        btn.onclick = () => {
          Object.entries(recipe.requires).forEach(([item, count]) => inventory[item] -= count);
          inventory[recipe.produces]++;
          updateCraftingMenu();
        };
        craftingArea.appendChild(btn);
      });
    }

    function isColliding(a, b) {
      return (
        a.x < b.x + b.size &&
        a.x + a.size > b.x &&
        a.y < b.y + b.size &&
        a.y + a.size > b.y
      );
    }

    function update() {
      if (keys.up) player.y -= player.speed;
      if (keys.down) player.y += player.speed;
      if (keys.left) player.x -= player.speed;
      if (keys.right) player.x += player.speed;

      resources.forEach((res, i) => {
        if (isColliding(player,
